{
 "$schema": "http://json-schema.org/draft-07/schema#",
 "title": "DevinClaw Evidence Pack",
 "description": "Schema for evidence-pack.json produced by every skill upon completion. Contains artifact inventory, verification results, and escalation records for audit trail compliance.",
 "type": "object",
 "required": ["session_id", "timestamp", "skill_id", "artifacts", "verification"],
 "properties": {
 "session_id": {
 "type": "string",
 "description": "Devin session identifier that produced this evidence pack"
 },
 "timestamp": {
 "type": "string",
 "format": "date-time",
 "description": "ISO 8601 completion timestamp in UTC"
 },
 "skill_id": {
 "type": "string",
 "pattern": "^devinclaw\\.[a-z_]+\\.v[0-9]+$",
 "description": "Skill identifier in the format devinclaw.<domain>.v<version>"
 },
 "work_order_id": {
 "type": "string",
 "description": "Parent work order or task identifier linking this evidence to the intake request"
 },
 "artifacts": {
 "type": "array",
 "minItems": 1,
 "items": {
 "type": "object",
 "required": ["filename", "sha256", "stage"],
 "properties": {
 "filename": {
 "type": "string",
 "description": "Relative path of the artifact file"
 },
 "sha256": {
 "type": "string",
 "pattern": "^[a-f0-9]{64}$",
 "description": "SHA-256 hash of the file contents for tamper detection"
 },
 "stage": {
 "type": "string",
 "description": "SDLC stage that produced this artifact (spec, design, test, build, review, evidence, deliver)"
 },
 "content_type": {
 "type": "string",
 "description": "MIME type of the artifact (e.g., text/markdown, application/json, application/xml)"
 }
 }
 }
 },
 "verification": {
 "type": "object",
 "required": ["gates_run", "gates_passed", "gates_failed"],
 "properties": {
 "gates_run": {
 "type": "array",
 "items": { "type": "string" },
 "description": "List of verification gate identifiers that were executed"
 },
 "gates_passed": {
 "type": "array",
 "items": { "type": "string" },
 "description": "Gates that passed verification"
 },
 "gates_failed": {
 "type": "array",
 "items": { "type": "string" },
 "description": "Gates that failed verification (empty array for full pass)"
 },
 "auto_fix_attempts": {
 "type": "integer",
 "minimum": 0,
 "description": "Number of automated fix attempts before final verification state"
 },
 "test_summary": {
 "type": "object",
 "properties": {
 "passed": { "type": "integer", "minimum": 0 },
 "failed": { "type": "integer", "minimum": 0 },
 "skipped": { "type": "integer", "minimum": 0 }
 }
 },
 "scan_summary": {
 "type": "object",
 "properties": {
 "critical": { "type": "integer", "minimum": 0 },
 "high": { "type": "integer", "minimum": 0 },
 "medium": { "type": "integer", "minimum": 0 },
 "low": { "type": "integer", "minimum": 0 }
 }
 },
 "coverage": {
 "type": "object",
 "properties": {
 "branch_percent": { "type": "number", "minimum": 0, "maximum": 100 },
 "line_percent": { "type": "number", "minimum": 0, "maximum": 100 }
 }
 }
 }
 },
 "knowledge_updates": {
 "type": "array",
 "items": {
 "type": "object",
 "required": ["action", "summary"],
 "properties": {
 "action": {
 "type": "string",
 "enum": ["created", "updated"]
 },
 "knowledge_id": {
 "type": "string",
 "description": "Devin knowledge entry identifier"
 },
 "summary": {
 "type": "string",
 "description": "Human-readable summary of what was learned"
 }
 }
 }
 },
 "escalations": {
 "type": "array",
 "items": {
 "type": "object",
 "required": ["gate", "reason"],
 "properties": {
 "gate": {
 "type": "string",
 "description": "Identifier of the failing verification gate"
 },
 "reason": {
 "type": "string",
 "description": "Explanation of why auto-fix failed"
 },
 "evidence": {
 "type": "string",
 "description": "Link or reference to error output supporting the escalation"
 },
 "attempts": {
 "type": "integer",
 "minimum": 1,
 "description": "Number of auto-fix attempts before escalation"
 }
 }
 }
 },
 "arena": {
 "type": "object",
 "description": "Present only for arena-run executions",
 "properties": {
 "mode": {
 "type": "string",
 "enum": ["single-run", "arena-run"]
 },
 "session_count": {
 "type": "integer",
 "minimum": 1
 },
 "divergence_score": {
 "type": "number",
 "minimum": 0,
 "maximum": 1
 },
 "resolution": {
 "type": "string",
 "enum": ["auto-merged", "targeted-verification", "human-escalated"]
 }
 }
 }
 }
}
